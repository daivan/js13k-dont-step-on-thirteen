(()=>{"use strict";var t,i,e,s,h={896:(t,i,e)=>{e.d(i,{Z:()=>n});var s=e(20);let h=document.createElement("canvas");h.width=576,h.height=576;let r=h.getContext("2d");function a(t){for(let n=0;n<t;n++)i=Math.random()*h.width,e=Math.random()*h.height,s=2*Math.random(),a=Math.random(),r.beginPath(),r.arc(i,e,s,0,2*Math.PI),r.fillStyle=`rgba(255, 255, 255, ${a})`,r.fill();var i,e,s,a;return h}r.fillStyle="black",r.fillRect(0,0,h.width,h.height);class n{constructor(t){this.sprite=t,this.columnTexts=[],this.numberOfColumns=8,this.horizontalNumbers=[],this.verticalNumbers=[],this.populateNumbers(),this.horizontalTexts=[],this.verticalTexts=[],this.updateNumberTexts(),this.colsWith13Sums=[],this.rowsWith13Sums=[],this.tilesWith13Sums=[],this.warningTiles=[],this.populateColsAndRowsWith13Sums(),this.populateWarningTiles(),this.grid=this.createGrid(t,this.getColsWith13Sums.bind(this),this.getRowsWith13Sums.bind(this),this.updateNumbers.bind(this),this.getCurrentLevel.bind(this)),this.background=this.createBackground(),this.level=1}getCurrentLevel(){return this.level}getColsWith13Sums(){return this.colsWith13Sums}getRowsWith13Sums(){return this.rowsWith13Sums}populateNumbers(){for(let t=0;t<this.numberOfColumns;t++)this.horizontalNumbers.push(Math.floor(9*Math.random())+1),this.verticalNumbers.push(Math.floor(9*Math.random())+1);this.horizontalNumbers[3]+this.verticalNumbers[3]===13&&(this.horizontalNumbers=[],this.verticalNumbers=[],this.populateNumbers())}updateNumbers(){this.horizontalNumbers.shift(),this.horizontalNumbers.push(Math.floor(9*Math.random())+1),this.verticalNumbers.shift(),this.verticalNumbers.push(Math.floor(9*Math.random())+1),this.updateNumberTexts(),this.populateColsAndRowsWith13Sums(),this.populateWarningTiles()}populateColsAndRowsWith13Sums(){this.colsWith13Sums=[],this.rowsWith13Sums=[],this.tilesWith13Sums=[];for(let t=0;t<this.numberOfColumns-1;t++)for(let i=0;i<this.numberOfColumns-1;i++)this.horizontalNumbers[t]+this.verticalNumbers[i]===13&&(this.colsWith13Sums.push(t),this.rowsWith13Sums.push(i),this.tilesWith13Sums.push({x:t,y:i}))}populateWarningTiles(){this.warningTiles=[],this.tilesWith13Sums.forEach((t=>{this.warningTiles.push((0,s.jy)({x:64*t.x+64,y:64*t.y+64,color:"#ae3b2f",alpha:255,width:64,height:64,render:function(){const t=`${this.color}${this.alpha.toString(16).padStart(2,"0")}`;this.context.fillStyle=t,this.context.fillRect(0,0,this.width,this.height)},update:function(t){this.alpha=this.alpha-Math.floor(200*t),this.alpha<0&&(this.alpha=0)}}))}))}updateNumberTexts(){this.horizontalTexts=[],this.verticalTexts=[];for(let t=0;t<this.numberOfColumns;t++){const i=64,e=5;this.horizontalTexts.push(new s.xv({text:this.horizontalNumbers[t].toString(),font:"20px Arial",color:"white",x:64*t+i/2-e+i,y:i/2-e})),this.verticalTexts.push(new s.xv({text:this.verticalNumbers[t].toString(),font:"20px Arial",color:"white",x:i/2-e/2,y:64*t+i/2-2*e+64}))}}createGrid(t,i,e,h,r){return(0,s.jy)({x:0,y:0,image:t,level:1,levelColors:["#e78ea799","#e38a3a99","#729d3f99","#aa4d8d99","#9fd7dd99","#ffffff99","#44444499"],greenColor:"#41772f",redColor:"#ae3b2f",tileSize:64,numRows:8,green:"#41772f",red:"#ae3b2f",drawCanon:function(t,i,e=!1,s=!1){if(!s){if(t!==8*this.tileSize){const s=e?this.red:this.green;this.context.fillStyle=s,this.context.fillRect(t+20,i+8,26,13)}this.context.drawImage(this.image,this.tileSize,0,this.tileSize,this.tileSize,t,i,this.tileSize,this.tileSize)}if(s){if(i!==8*this.tileSize){const s=e?this.red:this.green;this.context.fillStyle=s,this.context.fillRect(t+8,i+20,13,26)}this.context.save(),this.context.translate(t,i+this.tileSize),this.context.rotate(-Math.PI/2),this.context.drawImage(this.image,this.tileSize,0,this.tileSize,this.tileSize,0,0,this.tileSize,this.tileSize),this.context.restore()}},render:function(){for(let t=0;t<this.numRows;t++)for(let s=0;s<this.numRows;s++){const h=s*this.tileSize,a=t*this.tileSize;if(0==(t+s)%2&&0!=t&&0!=s){const t=this.levelColors[r()-1];this.context.fillStyle=t,this.context.fillRect(h,a,this.tileSize,this.tileSize),this.context.drawImage(this.image,0,0,this.tileSize,this.tileSize,h,a,this.tileSize,this.tileSize)}0==t&&0!=s&&this.drawCanon(h,a,i().includes(s-1)),0==s&&0!=t&&this.drawCanon(h,a,e().includes(t-1),!0)}this.drawCanon(0,8*this.tileSize,!1,!0),this.drawCanon(8*this.tileSize,0,!1,!1)},update:function(t){this.timeSinceLastUpdate=this.timeSinceLastUpdate||0,this.timeSinceLastUpdate+=t,this.timeSinceLastUpdate>5/r()&&(h(),this.timeSinceLastUpdate=0)}})}createBackground(){return(0,s.jy)({x:0,y:0,image:a(500)})}update(t){this.grid.update(t),this.warningTiles.forEach((i=>i.update(t)))}render(){this.background.render(),this.grid.render(),this.warningTiles.forEach((t=>t.render())),this.horizontalTexts.forEach((t=>t.render())),this.verticalTexts.forEach((t=>t.render()))}}},916:(t,i,e)=>{e.d(i,{Z:()=>h});var s=e(20);(0,s.CX)();class h extends s.GH{constructor(t,i){super(i),this.gameState=t,this.title=new s.xv({text:"You died",font:"20px Arial",color:"white",x:20,y:40}),this.subTitle=new s.xv({text:"Press [Enter] to try again",font:"20px Arial",color:"white",x:20,y:100})}update(t){(0,s.$G)("enter")&&this.gameState.startGame()}render(){this.title.render(),this.subTitle.render()}}},379:(t,i,e)=>{e.d(i,{Z:()=>h});var s=e(20);(0,s.CX)();class h extends s.GH{constructor(t,i,e){super(e),this.sprite=t,this.gameArea=i,this.score=0,this.level=1,this.maxLevel=7,this.gameOver=!1,this.gameObjects=[],this.scene="START",this.goalSprite=(0,s.jy)({x:64*Math.floor(7*Math.random())+64,y:64*Math.floor(7*Math.random())+64,radius:32,color:"#edc06d",render(){this.context.fillStyle="#00000055",this.context.beginPath(),this.context.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.context.fill();const t=this.context.createRadialGradient(this.radius/1.3,this.radius/1.3,0,0,0,2*this.radius);t.addColorStop(0,"#edc06dff"),t.addColorStop(1,"#edc06d00"),this.context.fillStyle=t,this.context.beginPath(),this.context.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.context.fill()}}),this.playerSprite=(0,s.jy)({x:288,y:288,velocity:{x:0,y:0},direction:{x:0,y:-1},anchor:{x:.5,y:.5},speed:2,size:64,rotation:0,customImage:this.sprite,render(){this.context.drawImage(this.customImage,128,0,this.size,this.size,-this.size/2,-this.size/2,this.size,this.size)},update(t,i){this.direction.x=0,this.direction.y=0,(0,s.$G)("w")&&(this.direction.y=-1),(0,s.$G)("s")&&(this.direction.y=1),(0,s.$G)("a")&&(this.direction.x=-1),(0,s.$G)("d")&&(this.direction.x=1),this.velocity.x=this.direction.x*this.speed,this.velocity.y=this.direction.y*this.speed,0!==this.velocity.x&&0!==this.velocity.y&&(this.velocity.x/=Math.sqrt(2),this.velocity.y/=Math.sqrt(2)),this.x+=this.velocity.x,this.y+=this.velocity.y,this.x<64+this.size/2&&(this.x=64+this.size/2),this.x>512-this.size/2&&(this.x=512-this.size/2),this.y<64+this.size/2&&(this.y=64+this.size/2),this.y>512-this.size/2&&(this.y=512-this.size/2),0===this.direction.x&&0===this.direction.y||(this.rotation=Math.atan2(this.direction.y,this.direction.x)+Math.PI/2)}})}startGame(){this.scene="GAME",this.playerSprite.x=100,this.playerSprite.y=100,this.gameOver=!1,this.score=0,this.level=1}createLasers(){const t=64*this.columnNumber+96,i=64*this.rowNumber+96,e=(this.colNumber,64*this.rowNumber+128);this.gameObjects.push((0,s.jy)({x:t,y:64,color:"#aa4d8dff",size:4,remove:!1,render(){this.context.fillStyle=this.color,this.context.fillRect(-this.size/2,0,this.size,e-this.y)},update(t){this.size+=this.size*t*50,this.size>48&&(this.size=48,this.remove=!0)}})),this.gameObjects.push((0,s.jy)({x:64,y:i,color:"#aa4d8dff",size:4,remove:!1,render(){this.context.fillStyle=this.color,this.context.fillRect(0,-this.size/2,t-32,this.size)},update(t){this.size+=this.size*t*50,this.size>48&&(this.size=48,this.remove=!0)}}))}createExplosion(){let t=[];for(let i=0;i<20;i++)t.push({x:this.playerSprite.x,y:this.playerSprite.y,radius:20*Math.random()+10,color:`rgba(255, ${255*Math.random()}, 0, 1)`,velocityX:4*(Math.random()-.5),velocityY:4*(Math.random()-.5),life:1});this.gameObjects.push((0,s.jy)({x:this.playerSprite.x,y:this.playerSprite.y,particles:t,update(){for(let t=this.particles.length-1;t>=0;t--){let i=this.particles[t];i.x+=i.velocityX,i.y+=i.velocityY,i.radius*=.97,i.life-=.02,i.life<=0&&this.particles.splice(t,1)}0===this.particles.length&&(this.ttl=0)},render(){this.particles.forEach((t=>{this.context.beginPath(),this.context.arc(t.x-this.x,t.y-this.y,t.radius,0,2*Math.PI,!1),this.context.fillStyle=t.color.replace("1)",`${t.life})`),this.context.fill()}))}}))}updateNumbers(){this.rowNumber=Math.floor(this.playerSprite.y/64)-1,this.columnNumber=Math.floor(this.playerSprite.x/64)-1,13===this.gameArea.verticalNumbers[this.rowNumber]+this.gameArea.horizontalNumbers[this.columnNumber]&&(this.createLasers(),this.gameOver=!0,this.createExplosion())}update(t){this.score===5*this.level&&(this.level=this.level+1,this.level>this.maxLevel&&(this.level=this.maxLevel,this.gameOver=!0),this.gameArea.level=this.level),this.gameObjects.forEach(((i,e)=>{i.update(t),i.remove&&this.gameObjects.splice(e,1)})),this.gameOver?this.scene="GAME_OVER":(this.playerSprite.update(),this.updateNumbers(),(0,s.YE)(this.playerSprite,this.goalSprite)&&(this.score=this.score+1,this.goalSprite.x=64*Math.floor(7*Math.random())+64,this.goalSprite.y=64*Math.floor(7*Math.random())+64))}render(){this.goalSprite.render(),this.gameObjects.forEach((t=>t.render())),this.gameOver?this.scene="GAME_OVER":this.playerSprite.render()}}},501:(t,i,e)=>{e.d(i,{Z:()=>h});var s=e(20);(0,s.CX)();class h extends s.GH{constructor(t,i){super(i),this.gameState=t,this.title=new s.xv({text:"Dont step on thirteen",font:"20px Arial",color:"white",x:20,y:40}),this.subTitle=new s.xv({text:"Press [Enter] to start",font:"20px Arial",color:"white",x:20,y:100})}update(t){(0,s.$G)("enter")&&this.gameState.startGame()}render(){this.title.render(),this.subTitle.render()}}},138:(t,i,e)=>{e.a(t,(async(t,i)=>{try{var s=e(20),h=e(379),r=e(896),a=e(501),n=e(916);let{canvas:t,context:o}=(0,s.S1)();t.width=576,t.height=576;const l=await(0,s.zD)("square.png");let c=new r.Z(l[0]),d=new h.Z(l[0],c),u=new a.Z(d),p=new n.Z(d);(0,s.DX)({update:function(t){"START"!=d.scene?"GAME_OVER"!=d.scene?(d.gameArea.update(t),d.update(t)):p.update():u.update()},render:function(){"START"!=d.scene?"GAME_OVER"!=d.scene?(d.gameArea.render(),d.render()):p.render():u.render()}}).start(),i()}catch(t){i(t)}}),1)},20:(t,i,e)=>{function s(t,i,e){return Math.min(Math.max(t,e),i)}function h(t,i){let e=r(t),s=r(i);return!(t.radius&&e.width!=e.height||i.radius&&s.width!=s.height)&&([e,s]=[e,s].map((s=>((s==e?t:i).radius&&(s.radius=s.width/2,s.x+=s.radius,s.y+=s.radius),s))),t.radius&&i.radius?Math.hypot(e.x-s.x,e.y-s.y)<e.radius+s.radius:t.radius||i.radius?function(t,i){let{x:e,y:s,width:h,height:a}=r(i);do{e-=i.sx||0,s-=i.sy||0}while(i=i.parent);let n=t.x-Math.max(e,Math.min(t.x,e+h)),o=t.y-Math.max(s,Math.min(t.y,s+a));return n*n+o*o<t.radius*t.radius}(t.radius?e:s,t.radius?i:t):e.x<s.x+s.width&&e.x+e.width>s.x&&e.y<s.y+s.height&&e.y+e.height>s.y)}function r(t){let{x:i=0,y:e=0,width:s,height:h,radius:r}=t.world||t;return t.mapwidth&&(s=t.mapwidth,h=t.mapheight),r&&(s=2*r.x,h=2*r.y),t.anchor&&(i-=s*t.anchor.x,e-=h*t.anchor.y),s<0&&(i+=s,s*=-1),h<0&&(e+=h,h*=-1),{x:i,y:e,width:s,height:h}}e.d(i,{$G:()=>J,CX:()=>K,DX:()=>$,GH:()=>j,S1:()=>x,YE:()=>h,jy:()=>L,xv:()=>I,zD:()=>P});let a=()=>{};let n,o,l={};function c(t,i){l[t]=l[t]||[],l[t].push(i)}function d(t,...i){(l[t]||[]).map((t=>t(...i)))}let u={get:(t,i)=>"_proxy"==i||a};function p(){return o}function x(t,{contextless:i=!1}={}){if(n=document.getElementById(t)||t||document.querySelector("canvas"),i&&(n=n||new Proxy({},u)),!n)throw Error("You must provide a canvas element for the game");return o=n.getContext("2d")||new Proxy({},u),o.imageSmoothingEnabled=!1,d("init"),{canvas:n,context:o}}let m=/(jpeg|jpg|gif|png|webp)$/,w=/(wav|mp3|ogg|aac)$/,y=/^\//,f=/\/$/,g=new WeakMap,_="",v="",S="";function b(t,i){return new URL(t,i).href}function z(t,i){return[t.replace(f,""),t?i.replace(y,""):i].filter((t=>t)).join("/")}function M(t){return t.split(".").pop()}function A(t){let i=t.replace("."+M(t),"");return 2==i.split("/").length?i.replace(y,""):i}let C={},E={},T={};function N(){window.__k||(window.__k={dm:g,u:b,d:T,i:C})}function P(...t){return N(),Promise.all(t.map((t=>{let i=M([].concat(t)[0]);return i.match(m)?(e=t,N(),new Promise(((t,i)=>{let s,h,r;if(s=z(_,e),C[s])return t(C[s]);h=new Image,h.onload=function(){r=b(s,window.location.href),C[A(e)]=C[s]=C[r]=this,d("assetLoaded",this,e),t(this)},h.onerror=function(){i("Unable to load image "+s)},h.src=s}))):i.match(w)?function(t){return new Promise(((i,e)=>{let s,h,r,a,n=t;var o;return s=new Audio,h={wav:(o=s).canPlayType('audio/wav; codecs="1"'),mp3:o.canPlayType("audio/mpeg;"),ogg:o.canPlayType('audio/ogg; codecs="vorbis"'),aac:o.canPlayType("audio/aac;")},(t=[].concat(t).reduce(((t,i)=>t||(h[M(i)]?i:null)),0))?(r=z(v,t),E[r]?i(E[r]):(s.addEventListener("canplay",(function(){a=b(r,window.location.href),E[A(t)]=E[r]=E[a]=this,d("assetLoaded",this,t),i(this)})),s.onerror=function(){e("Unable to load audio "+r)},s.src=r,void s.load())):e("cannot play any of the audio formats provided "+n)}))}(t):function(t){let i,e;return N(),i=z(S,t),T[i]?Promise.resolve(T[i]):fetch(i).then((t=>{if(!t.ok)throw t;return t.clone().json().catch((()=>t.text()))})).then((s=>(e=b(i,window.location.href),"object"==typeof s&&g.set(s,e),T[A(t)]=T[i]=T[e]=s,d("assetLoaded",s,t),s)))}(t);var e})))}class O{constructor(t=0,i=0,e={}){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=i),e._c&&(this.clamp(e._a,e._b,e._d,e._e),this.x=t,this.y=i)}set(t){this.x=t.x,this.y=t.y}add(t){return new O(this.x+t.x,this.y+t.y,this)}subtract(t){return new O(this.x-t.x,this.y-t.y,this)}scale(t){return new O(this.x*t,this.y*t)}normalize(t=this.length()||1){return new O(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,i,e,s){this._c=!0,this._a=t,this._b=i,this._d=e,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?s(this._a,this._d,t):t}set y(t){this._y=this._c?s(this._b,this._e,t):t}}function R(){return new O(...arguments)}class W{constructor(t){return this.init(t)}init(t={}){this.position=R(),this.velocity=R(),this.acceleration=R(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.acceleration;t&&(i=i.scale(t)),this.velocity=this.velocity.add(i);let e=this.velocity;t&&(e=e.scale(t)),this.position=this.position.add(e),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}class j extends W{init({width:t=0,height:i=0,context:e=p(),render:s=this.draw,update:h=this.advance,children:r=[],anchor:a={x:0,y:0},opacity:n=1,rotation:o=0,drotation:l=0,ddrotation:d=0,scaleX:u=1,scaleY:x=1,...m}={}){this._c=[],super.init({width:t,height:i,context:e,anchor:a,opacity:n,rotation:o,drotation:l,ddrotation:d,scaleX:u,scaleY:x,...m}),this._di=!0,this._uw(),this.addChild(r),this._rf=s,this._uf=h,c("init",(()=>{this.context??=p()}))}update(t){this._uf(t),this.children.map((i=>i.update&&i.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let i=this.width,e=this.height;this.radius&&(i=e=2*this.radius);let s=-i*this.anchor.x,h=-e*this.anchor.y;(s||h)&&t.translate(s,h),this.context.globalAlpha=this.opacity,this._rf(),(s||h)&&t.translate(-s,-h),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:e=1,_wrot:s=0,_wsx:h=1,_wsy:r=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this.radius&&(this._wrx=this.radius,this._wry=this.radius),this._wo=e*this.opacity,this._wsx=h*this.scaleX,this._wsy=r*this.scaleY,this._wx=this._wx*h,this._wy=this._wy*r,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this.radius&&(this._wrx=this.radius*this._wsx,this._wry=this.radius*this._wsy),this._wrot=s+this.rotation;let{x:a,y:n}=function(t,i){let e=Math.sin(i),s=Math.cos(i);return{x:t.x*s-t.y*e,y:t.x*e+t.y*s}}({x:this._wx,y:this._wy},s);this._wx=a,this._wy=n,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,radius:this.radius?{x:this._wrx,y:this._wry}:void 0,opacity:this._wo,rotation:this._wrot,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map((t=>{this.children.push(t),t.parent=this,t._pc=t._pc||a,t._pc()}))}removeChild(...t){t.flat().map((t=>{(function(t,i){let e=t.indexOf(i);if(-1!=e)return t.splice(e,1),!0})(this.children,t)&&(t.parent=null,t._pc())}))}get radius(){return this._r}set radius(t){this._r=t,this._pc()}get opacity(){return this._opa}set opacity(t){this._opa=s(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}advance(t){super.advance(t),this.drotation+=this.ddrotation,this.rotation+=this.drotation}setScale(t,i=t){this.scaleX=t,this.scaleY=i}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}class k extends j{init({image:t,width:i=(t?t.width:void 0),height:e=(t?t.height:void 0),...s}={}){super.init({image:t,width:i,height:e,...s})}get animations(){return this._a}set animations(t){let i,e;for(i in this._a={},t)this._a[i]=t[i].clone(),e=e||this._a[i];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}playAnimation(t){this.currentAnimation?.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start()}advance(t){super.advance(t),this.currentAnimation?.update(t)}draw(){if(this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color){if(this.context.fillStyle=this.color,this.radius)return this.context.beginPath(),this.context.arc(this.radius,this.radius,this.radius,0,2*Math.PI),void this.context.fill();this.context.fillRect(0,0,this.width,this.height)}}}function L(){return new k(...arguments)}let G=/(\d+)(\w+)/;class X extends j{init({text:t="",textAlign:i="",lineHeight:e=1,font:s=p()?.font,...h}={}){t=""+t,super.init({text:t,textAlign:i,lineHeight:e,font:s,...h}),this.context&&this._p(),c("init",(()=>{this.font??=p().font,this._p()}))}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=function(t){if(!t)return{computed:0};let i=t.match(G),e=+i[1];return{size:e,unit:i[2],computed:e}}(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context,i=[this.text];if(t.font=this.font,i=this.text.split("\n"),this._fw&&i.map((i=>{let e=i.split(" "),s=e.shift(),h=s;e.map((i=>{h+=" "+i,t.measureText(h).width>this._fw&&(this._s.push(s),h=i),s=h})),this._s.push(h)})),!this._s.length&&this.text.includes("\n")){let e=0;i.map((i=>{this._s.push(i),e=Math.max(e,t.measureText(i).width)})),this._w=this._fw||e}this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=0,i=this.textAlign,e=this.context;i=this.textAlign||("rtl"==e.canvas.dir?"right":"left"),t="right"==i?this.width:"center"==i?this.width/2|0:0,this._s.map(((s,h)=>{e.textBaseline="top",e.textAlign=i,e.fillStyle=this.color,e.font=this.font,this.strokeColor&&(e.strokeStyle=this.strokeColor,e.lineWidth=this.lineWidth??1,e.strokeText(s,t,this._fs*this.lineHeight*h)),e.fillText(s,t,this._fs*this.lineHeight*h)}))}}function I(){return new X(...arguments)}function Y(t){let i=t.canvas;t.clearRect(0,0,i.width,i.height)}function $({fps:t=60,clearCanvas:i=!0,update:e=a,render:s,context:h=p(),blur:r=!1}={}){if(!s)throw Error("You must provide a render() function");let n,o,l,u,x,m=0,w=1e3/t,y=1/t,f=i?Y:a,g=!0;function _(){if(o=requestAnimationFrame(_),g&&(l=performance.now(),u=l-n,n=l,!(u>1e3))){for(m+=u;m>=w;)d("tick"),x.update(y),m-=w;f(x.context),x.render()}}return r||(window.addEventListener("focus",(()=>{g=!0})),window.addEventListener("blur",(()=>{g=!1}))),c("init",(()=>{x.context??=p()})),x={update:e,render:s,isStopped:!0,context:h,start(){this.isStopped&&(n=performance.now(),this.isStopped=!1,requestAnimationFrame(_))},stop(){this.isStopped=!0,cancelAnimationFrame(o)},_frame:_,set _last(t){n=t}},x}new WeakMap;let H={},U={},q={},D={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function Z(t=a,i){t._pd&&i.preventDefault(),t(i)}function B(t){let i=D[t.code],e=H[i];q[i]=!0,Z(e,t)}function V(t){let i=D[t.code],e=U[i];q[i]=!1,Z(e,t)}function F(){q={}}function K(){let t;for(t=0;t<26;t++)D["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)D["Digit"+t]=D["Numpad"+t]=""+t;window.addEventListener("keydown",B),window.addEventListener("keyup",V),window.addEventListener("blur",F)}function J(t){return!![].concat(t).some((t=>q[t]))}}},r={};function a(t){var i=r[t];if(void 0!==i)return i.exports;var e=r[t]={exports:{}};return h[t](e,e.exports,a),e.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",i="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",e="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",s=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},a.a=(h,r,a)=>{var n;a&&((n=[]).d=-1);var o,l,c,d=new Set,u=h.exports,p=new Promise(((t,i)=>{c=i,l=t}));p[i]=u,p[t]=t=>(n&&t(n),d.forEach(t),p.catch((t=>{}))),h.exports=p,r((h=>{var r;o=(h=>h.map((h=>{if(null!==h&&"object"==typeof h){if(h[t])return h;if(h.then){var r=[];r.d=0,h.then((t=>{a[i]=t,s(r)}),(t=>{a[e]=t,s(r)}));var a={};return a[t]=t=>t(r),a}}var n={};return n[t]=t=>{},n[i]=h,n})))(h);var a=()=>o.map((t=>{if(t[e])throw t[e];return t[i]})),l=new Promise((i=>{(r=()=>i(a)).r=0;var e=t=>t!==n&&!d.has(t)&&(d.add(t),t&&!t.d&&(r.r++,t.push(r)));o.map((i=>i[t](e)))}));return r.r?l:a()}),(t=>(t?c(p[e]=t):l(u),s(n)))),n&&n.d<0&&(n.d=0)},a.d=(t,i)=>{for(var e in i)a.o(i,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},a.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),a(138)})();